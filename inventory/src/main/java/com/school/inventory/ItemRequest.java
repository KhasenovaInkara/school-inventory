package com.school.inventory;

import jakarta.persistence.*;
import lombok.Data;
import java.time.LocalDateTime;

/**
 * Сущность, представляющая заявку на выдачу инвентарной единицы.
 * <p>
 * Класс служит связующим звеном в бизнес-процессе оборота имущества.
 * Фиксирует факт запроса предмета конкретным пользователем и отслеживает
 * статус обработки этого запроса (Жизненный цикл заявки).
 * <p>
 * Реализация требований:
 * - №1 (Структура классов и архитектура: связи между сущностями).
 * - №5 (Хранение реляционных данных).
 */
@Entity
@Data
@Table(name = "requests")
public class ItemRequest {

    /**
     * Уникальный идентификатор заявки.
     * Первичный ключ (Primary Key) в базе данных.
     */
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    /**
     * Ссылка на запрашиваемую инвентарную единицу.
     * <p>
     * Реализует отношение "Многие-к-Одному" (@ManyToOne):
     * на один предмет может быть создано множество исторических заявок.
     * В БД хранится как внешний ключ (Foreign Key) "item_id".
     */
    @ManyToOne
    @JoinColumn(name = "item_id")
    private InventoryItem item;

    /**
     * Ссылка на пользователя, инициировавшего запрос.
     * <p>
     * Реализует отношение "Многие-к-Одному" (@ManyToOne):
     * один пользователь может создавать множество заявок.
     * В БД хранится как внешний ключ (Foreign Key) "user_id".
     */
    @ManyToOne
    @JoinColumn(name = "user_id")
    private AppUser requester; 

    /**
     * Текущий статус жизненного цикла заявки.
     * <p>
     * Возможные значения (определены бизнес-логикой):
     * - "PENDING": Ожидает рассмотрения администратором.
     * - "APPROVED": Заявка одобрена, предмет выдан (числится за пользователем).
     * - "REJECTED": Отказано в выдаче.
     * - "RETURNED": Предмет возвращен на склад, цикл завершен.
     */
    private String status; 

    /**
     * Временная метка создания заявки.
     * Используется для сортировки и аудита хронологии запросов.
     */
    private LocalDateTime createdAt;
}